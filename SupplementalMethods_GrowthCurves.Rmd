---
title: "SupplementalMethods_GrowthCurves"
author: "Tommy Tran"
date: "`r Sys.Date()`"
output: html_document
---

```{r}
# Install and load necessary packages
if (!requireNamespace("ggplot2", quietly = TRUE)) {
  install.packages("ggplot2")
}
if (!requireNamespace("tidyverse", quietly = TRUE)) {
  install.packages("tidyverse")
}

library(ggplot2)
library(tidyverse)
```

```{r}
# Read your CSV file (replace 'your_data.csv' with the actual file path)
"C:/Users/tommy/Downloads/Growth_Curves.csv" <- "Growth_Curves.csv"
data <- read.csv("C:/Users/tommy/Downloads/Growth_Curves.csv")
```

```{r}
# Filter out rows with Rejected == TRUE
data <- data %>% 
  filter(Rejected == FALSE)
```

```{r}
# Convert Media to a factor for proper plotting order
data$Media <- factor(data$Media, levels = c("2p", "5p"))
```

```{r}
# Group by Species, Time, and Media, calculate the average OD
avg_data <- data %>%
  group_by(Species, Time, Media) %>%
  summarise(AvgOD = mean(OD),
            SE = sd(OD) / sqrt(n()))
```

```{r}
# Create the plot with dots and error bars
p <- ggplot(avg_data, aes(x = Time, y = AvgOD, color = Media, group = Media)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = AvgOD - SE, ymax = AvgOD + SE), width = 0.2) +
  labs(title = "CorPGA Bacterial Growth Curves",
       x = "Time (hours)",
       y = "Average OD600 (Optical Density)",
       color = "Media",
       caption = "Lines represent 2p (2% glucose) or 5p (5% glucose) in nCDM v5\nâ€¢ Dots indicate average OD600 at specific time points, across n=3 independent experiments") +
  facet_wrap(~Species, scales = "free_y") +
  theme_bw() +
  theme(
    plot.title = element_text(size = 14, face = "bold", margin = margin(b = 10)),
    plot.caption = element_text(size = 10, margin = margin(t = 10))
  )
```


```{r}
# Save the plot as a PNG file
print(p)
ggsave("C:/Users/tommy/Downloads/CorPGA_growth_curves.png", p, width = 10, height = 6, units = "in")
```

# Combined species for 2p and 5p
```{r}
# Assuming your data frame is named 'data'
# Read your CSV file (replace 'your_data.csv' with the actual file path)
file_path <- "C:/Users/tommy/Downloads/Growth_Curves.csv"
data <- read.csv(file_path)

# Filter out rows with Rejected == TRUE
data <- data %>%
  filter(Rejected == FALSE)

# Convert Media to a factor for proper plotting order
data$Media <- factor(data$Media, levels = c("2p", "5p"))

# Group by Time, Media, and calculate the average OD and SE
avg_data <- data %>%
  group_by(Time, Media) %>%
  summarise(AvgOD = mean(OD),
            SE = sd(OD) / sqrt(n()))
```

```{r}
# Create the plot for 2p
p_2p <- ggplot(avg_data %>% filter(Media == "2p"), aes(x = Time, y = AvgOD, color = Species, group = Species)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = AvgOD - SE, ymax = AvgOD + SE), width = 0.2) +
  labs(title = "Bacterial Growth Curve (2p)",
       x = "Time (hours)",
       y = "Average OD (Optical Density)",
       color = "Species") +
  theme_minimal()

```

```{r}
# Create the plot for 5p
p_5p <- ggplot(avg_data %>% filter(Media == "5p"), aes(x = Time, y = AvgOD, color = Species, group = Species)) +
  geom_line() +
  geom_point() +
  geom_errorbar(aes(ymin = AvgOD - SE, ymax = AvgOD + SE), width = 0.2) +
  labs(title = "Bacterial Growth Curve (5p)",
       x = "Time (hours)",
       y = "Average OD (Optical Density)",
       color = "Species") +
  theme_minimal()
```

```{r}
# Save the plots as PNG files
ggsave("C:/Users/tommy/Downloads/bacterial_growth_curve_2p.png", p_2p, width = 10, height = 6, units = "in")
ggsave("C:/Users/tommy/Downloads/bacterial_growth_curve_5p.png", p_5p, width = 10, height = 6, units = "in")
```



